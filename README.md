README_vA6_main — 運用版（完成形）

この文書は、vA6 システムを最短手順で再構築・運用するためのマニュアルである。
思想・検証・背景は README_vA6_dev.md に記録されている。
本書では、実務に必要な「手順」「構造」「注意点」のみを記載する。

第1章：目的と概要
🎯 目的

無料で常時稼働し続ける「自己修復型システム」を維持すること。

事故後でも 30分以内（RTO）・1日以内（RPO） で完全復旧できること。

👤 対象読者

Render／Neon／GitHub／UptimeRobot を使用する管理者。

システム復旧・検証・メンテナンスを行う後継者。

第2章：環境構成
層	サービス	役割	備考
Render	Node.js	APIサーバ	/health, /notes, /export.csv 常時稼働
Neon	PostgreSQL	データベース	PITR・スナップショット対応
GitHub	Actions + Pages	自動バックアップ／UI配信	Publicリポジトリで無料運用
UptimeRobot	外部監視	常時稼働維持	15分間隔チェックでRender休眠防止

この4層をもって「クラウドオンリー構成」を実現し、
ローカルPCが破損しても即復旧可能な体制を保つ。

第3章：初期構築手順（5クリック＋数回コピペ）

1️⃣ Render 環境を作成し、/health 応答を確認（503→200へ）。
2️⃣ GitHub Actions で /export.csv の自動バックアップを有効化。
3️⃣ Neon のDB構造を初期化し、init.sql を実行してスキーマを構築。
　　続けて CSV復旧テスト を実施。
4️⃣ UptimeRobot を設定し、Render のスリープを防止。
5️⃣ /notes CRUD 操作を確認し、UIから正常応答を検証。

→ 以上5工程をもって「思想・設計・運用」が1点に収束する。

第4章：監視・バックアップ・復旧確認

vA6_main では「監視」と「バックアップ」を一体設計として扱う。
Render・GitHub・Neon の3層を循環的に保守し、
異常検知から自動復旧までを網羅する。

4.1 自動監視構成
監視層	ツール	対象API	動作
外部監視	UptimeRobot	/health	15分間隔でPing監視。503応答時に自動再起動。
内部監視	GitHub Actions	/export.csv	日次エクスポート＋Issue起票。バックアップ履歴を記録。
4.2 復旧訓練（RTO／RPOドリル）

RTO訓練：Render を強制停止→再起動までの時間を計測。

RPO訓練：Neon のCSVバックアップを復旧し、差異を確認。

訓練結果を /docs/backups/ に保存し、
30分以内（RTO）・1日以内（RPO） を達成していることを確認する。

4.3 人的操作ポイント（最小介入）
対象	操作内容	頻度
GitHub Actions	失敗時の再実行	必要時のみ
Neon	月次バックアップ＋PITR確認	1回／月
README更新	成果記録・方針転換	主要更新時のみ

自動化の目的は「人が触れなくても壊れない」ことではなく、
「人が触れても壊れない範囲に制御する」ことにある。

第5章：凍結ポリシーと継承方針

本書は vA6 系統の最終安定版 として位置づけられる。
以降のバージョンは思想検証を目的とする別ブランチ（例：vA7_dev）にて実施する。

5.1 凍結ポリシー

vA6_main は「運用の安定版」として凍結。

vA6_dev は「思想・検証の記録版」として保存。

双方は相互参照可能な状態を維持し、混同を防ぐ。

修正・機能追加は vA7以降 にて分岐管理する。

5.2 継承と再利用

README_vA6_main.md は Render と直接同期可能な構成。

Render 停止時も GitHub Pages で手順確認が可能。

後継者は本書を「再構築用ドキュメント」として使用。

付録：Quickガイド参照リンク

初心者や再構築支援者向けに、
より簡潔な手順書 README_vA6_quick.md を別途用意している。

ファイル	内容	用途
README_vA6_quick.md	初期構築・復旧・検証をまとめたクイックスタート版	Render同期時の参照
README_vA6_dev.md	思想・検証・履歴記録	技術的背景の理解補助
README_vA4+.md	旧Render同期版（archive予定）	移行後は参照のみ可

運用中の更新方針：
minor修正は Quick版 に反映し、main は変更せず保守的に維持する。

🧩 最終確認表（安定稼働チェック）
層	チェック項目	状態	確認日
Render	/health が200応答する	✅	yyyy/mm/dd（例：2025/11/10）
Neon	CSVエクスポート／復旧成功	✅	yyyy/mm/dd（例：2025/11/10）
GitHub Actions	自動バックアップ実行・Issue正常	✅	yyyy/mm/dd（例：2025/11/10）
UptimeRobot	外部監視が15分周期で動作	✅	yyyy/mm/dd（例：2025/11/10）

この表は、運用者・後継者が日次／月次点検時に更新する。

✅ 整合性確認済み

README_vA6_dev.md：思想・試行・技術記録と完全一致。

README_vA6_quick.md：手順・構築内容・文言完全整合。

vA6_main は正式に「運用安定版（完成形）」として確定。
